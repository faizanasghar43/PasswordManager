<!--&lt;!&ndash;<!DOCTYPE html>&ndash;&gt;-->
<!--&lt;!&ndash;<html lang="en">&ndash;&gt;-->
<!--&lt;!&ndash;<head>&ndash;&gt;-->
<!--&lt;!&ndash;    <meta charset="UTF-8">&ndash;&gt;-->
<!--&lt;!&ndash;    <meta http-equiv="X-UA-Compatible" content="IE=edge">&ndash;&gt;-->
<!--&lt;!&ndash;    <meta name="viewport" content="width=device-width, initial-scale=1.0">&ndash;&gt;-->
<!--&lt;!&ndash;    <link rel="preconnect" href="https://fonts.googleapis.com">&ndash;&gt;-->
<!--&lt;!&ndash;    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>&ndash;&gt;-->
<!--&lt;!&ndash;    <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@300&display=swap" rel="stylesheet">&ndash;&gt;-->
<!--&lt;!&ndash;    <link rel="stylesheet" href="css/password-view.css">&ndash;&gt;-->
<!--&lt;!&ndash;    <link rel="stylesheet" href="css/user-menu.css">&ndash;&gt;-->
<!--&lt;!&ndash;    <title>Password Manager</title>&ndash;&gt;-->
<!--&lt;!&ndash;</head>&ndash;&gt;-->
<!--&lt;!&ndash;<body>&ndash;&gt;-->

<!--&lt;!&ndash;&lt;!&ndash; Password Manager Main UI &ndash;&gt;&ndash;&gt;-->
<!--&lt;!&ndash;<div class="navigation">&ndash;&gt;-->
<!--&lt;!&ndash;    <input class="search-bar" type="search" placeholder="Filter Platform & Username">&ndash;&gt;-->

<!--&lt;!&ndash;    <nav class="btn-set1">&ndash;&gt;-->
<!--&lt;!&ndash;        <input class="action-btn logout" type="button" onclick="logout()">&ndash;&gt;-->
<!--&lt;!&ndash;        <input class="action-btn add-record" type="button" onclick="openAddRecord()">&ndash;&gt;-->
<!--&lt;!&ndash;        <input class="action-btn remove-record" type="button" onclick="removeRecord()">&ndash;&gt;-->
<!--&lt;!&ndash;    </nav>&ndash;&gt;-->

<!--&lt;!&ndash;    <nav class="btn-set2">&ndash;&gt;-->
<!--&lt;!&ndash;        <input class="action-btn confirm-delete" type="button" onclick="confirmDelete()">&ndash;&gt;-->
<!--&lt;!&ndash;        <input class="action-btn cancel-delete" type="button" onclick="cancelDelete()">&ndash;&gt;-->
<!--&lt;!&ndash;    </nav>&ndash;&gt;-->
<!--&lt;!&ndash;</div>&ndash;&gt;-->

<!--&lt;!&ndash;<div class="table-container">&ndash;&gt;-->
<!--&lt;!&ndash;    <div id="addRecordModal" class="modal" style="display:none;">&ndash;&gt;-->
<!--&lt;!&ndash;        <div class="modal-content">&ndash;&gt;-->
<!--&lt;!&ndash;            <span class="close-button" onclick="closeModal()">&times;</span>&ndash;&gt;-->
<!--&lt;!&ndash;            <h2>Add New Credential</h2>&ndash;&gt;-->
<!--&lt;!&ndash;            <form id="addCredentialForm">&ndash;&gt;-->
<!--&lt;!&ndash;                <label for="platform">Platform:</label>&ndash;&gt;-->
<!--&lt;!&ndash;                <input type="text" id="platform" name="platform" required>&ndash;&gt;-->

<!--&lt;!&ndash;                <label for="username">Username:</label>&ndash;&gt;-->
<!--&lt;!&ndash;                <input type="text" id="username" name="username" required>&ndash;&gt;-->

<!--&lt;!&ndash;                <label for="password">Password:</label>&ndash;&gt;-->
<!--&lt;!&ndash;                <input type="password" id="password" name="password" required>&ndash;&gt;-->

<!--&lt;!&ndash;                <button type="button" onclick="addCredential()">Add Credential</button>&ndash;&gt;-->
<!--&lt;!&ndash;            </form>&ndash;&gt;-->
<!--&lt;!&ndash;        </div>&ndash;&gt;-->
<!--&lt;!&ndash;    </div>&ndash;&gt;-->

<!--&lt;!&ndash;    <table class="styled-table">&ndash;&gt;-->
<!--&lt;!&ndash;        <thead>&ndash;&gt;-->
<!--&lt;!&ndash;            <tr>&ndash;&gt;-->
<!--&lt;!&ndash;                <th class="selection">Selection</th>&ndash;&gt;-->
<!--&lt;!&ndash;                <th>Platform</th>&ndash;&gt;-->
<!--&lt;!&ndash;                <th>Username</th>&ndash;&gt;-->
<!--&lt;!&ndash;                <th>Password</th>&ndash;&gt;-->
<!--&lt;!&ndash;            </tr>&ndash;&gt;-->
<!--&lt;!&ndash;        </thead>&ndash;&gt;-->
<!--&lt;!&ndash;        <tbody>&ndash;&gt;-->
<!--&lt;!&ndash;            &lt;!&ndash; Data will be populated here &ndash;&gt;&ndash;&gt;-->
<!--&lt;!&ndash;        </tbody>&ndash;&gt;-->
<!--&lt;!&ndash;    </table>&ndash;&gt;-->
<!--&lt;!&ndash;</div>&ndash;&gt;-->

<!--&lt;!&ndash;<script>&ndash;&gt;-->
<!--&lt;!&ndash;        let credentials = []; // Define credentials globally&ndash;&gt;-->
<!--&lt;!&ndash;        let recordsToDeleteNames = []; // Define recordsToDeleteNames globally&ndash;&gt;-->

<!--&lt;!&ndash;    async function getUserData() {&ndash;&gt;-->
<!--&lt;!&ndash;        try {&ndash;&gt;-->
<!--&lt;!&ndash;            const token = localStorage.getItem('token'); // Retrieve the token from local storage&ndash;&gt;-->
<!--&lt;!&ndash;            const response = await fetch('http://localhost:3000/data', {&ndash;&gt;-->
<!--&lt;!&ndash;                method: 'GET',&ndash;&gt;-->
<!--&lt;!&ndash;                headers: {&ndash;&gt;-->
<!--&lt;!&ndash;                    'Authorization': `Bearer ${token}` // Include the token in the Authorization header&ndash;&gt;-->
<!--&lt;!&ndash;                }&ndash;&gt;-->
<!--&lt;!&ndash;            });&ndash;&gt;-->
<!--&lt;!&ndash;            if (response.ok) {&ndash;&gt;-->
<!--&lt;!&ndash;                const data = await response.json();&ndash;&gt;-->
<!--&lt;!&ndash;                populateTable(data.credentials);&ndash;&gt;-->
<!--&lt;!&ndash;            } else {&ndash;&gt;-->
<!--&lt;!&ndash;                console.error('Error fetching user data:', response.statusText);&ndash;&gt;-->
<!--&lt;!&ndash;                // Optionally, redirect to login page if unauthorized&ndash;&gt;-->
<!--&lt;!&ndash;                if (response.status === 401) {&ndash;&gt;-->
<!--&lt;!&ndash;                    window.location.href = 'login.html';&ndash;&gt;-->
<!--&lt;!&ndash;                }&ndash;&gt;-->
<!--&lt;!&ndash;            }&ndash;&gt;-->
<!--&lt;!&ndash;        } catch (error) {&ndash;&gt;-->
<!--&lt;!&ndash;            console.error('Error during getUserData:', error);&ndash;&gt;-->
<!--&lt;!&ndash;        }&ndash;&gt;-->
<!--&lt;!&ndash;    }&ndash;&gt;-->

<!--&lt;!&ndash;    function populateTable(credentials) {&ndash;&gt;-->
<!--&lt;!&ndash;        const tbody = document.querySelector('.styled-table tbody');&ndash;&gt;-->
<!--&lt;!&ndash;        tbody.innerHTML = ''; // Clear existing rows&ndash;&gt;-->

<!--&lt;!&ndash;        credentials.forEach((credential) => {&ndash;&gt;-->
<!--&lt;!&ndash;            const row = document.createElement('tr');&ndash;&gt;-->
<!--&lt;!&ndash;            row.innerHTML = `&ndash;&gt;-->
<!--&lt;!&ndash;                <td class="selection"><input type="checkbox"></td>&ndash;&gt;-->
<!--&lt;!&ndash;                <td>${credential.service}</td>&ndash;&gt;-->
<!--&lt;!&ndash;                <td>${credential.username}</td>&ndash;&gt;-->
<!--&lt;!&ndash;                <td>&ndash;&gt;-->
<!--&lt;!&ndash;                    <span class="password-display" data-password="${credential.password}">********</span>&ndash;&gt;-->
<!--&lt;!&ndash;                    <span class="eye-icon" onclick="togglePasswordVisibility(this)">üëÅÔ∏è</span>&ndash;&gt;-->
<!--&lt;!&ndash;                    <span class="clipboard-icon" onclick="copyToClipboard('${credential.password}')">üìã</span>&ndash;&gt;-->
<!--&lt;!&ndash;                </td>&ndash;&gt;-->
<!--&lt;!&ndash;            `;&ndash;&gt;-->
<!--&lt;!&ndash;            tbody.appendChild(row);&ndash;&gt;-->
<!--&lt;!&ndash;        });&ndash;&gt;-->
<!--&lt;!&ndash;    }&ndash;&gt;-->

<!--&lt;!&ndash;    function togglePasswordVisibility(icon) {&ndash;&gt;-->
<!--&lt;!&ndash;        const passwordDisplay = icon.parentElement.querySelector('.password-display');&ndash;&gt;-->
<!--&lt;!&ndash;        const actualPassword = passwordDisplay.getAttribute('data-password');&ndash;&gt;-->
<!--&lt;!&ndash;        passwordDisplay.textContent = passwordDisplay.textContent === '********' ? actualPassword : '********';&ndash;&gt;-->
<!--&lt;!&ndash;    }&ndash;&gt;-->

<!--&lt;!&ndash;    function copyToClipboard(text) {&ndash;&gt;-->
<!--&lt;!&ndash;        navigator.clipboard.writeText(text).then(() => {&ndash;&gt;-->
<!--&lt;!&ndash;            alert('Password copied to clipboard!');&ndash;&gt;-->
<!--&lt;!&ndash;        }, (err) => {&ndash;&gt;-->
<!--&lt;!&ndash;            console.error('Error copying text to clipboard', err);&ndash;&gt;-->
<!--&lt;!&ndash;        });&ndash;&gt;-->
<!--&lt;!&ndash;    }&ndash;&gt;-->

<!--&lt;!&ndash;    // Call getUserData when the page loads&ndash;&gt;-->
<!--&lt;!&ndash;    window.addEventListener('DOMContentLoaded', (event) => {&ndash;&gt;-->
<!--&lt;!&ndash;        getUserData();&ndash;&gt;-->
<!--&lt;!&ndash;    });&ndash;&gt;-->

<!--&lt;!&ndash;    function logout() {&ndash;&gt;-->
<!--&lt;!&ndash;        localStorage.removeItem('userSession');&ndash;&gt;-->
<!--&lt;!&ndash;        window.location.href = 'login.html';&ndash;&gt;-->
<!--&lt;!&ndash;    }&ndash;&gt;-->

<!--&lt;!&ndash;    function openAddRecord() {&ndash;&gt;-->
<!--&lt;!&ndash;        document.getElementById('addRecordModal').style.display = 'block';&ndash;&gt;-->
<!--&lt;!&ndash;    }&ndash;&gt;-->

<!--&lt;!&ndash;    function removeRecord() {&ndash;&gt;-->
<!--&lt;!&ndash;        // This would be triggered by selecting records to delete, typically using checkboxes&ndash;&gt;-->
<!--&lt;!&ndash;        const checkboxes = document.querySelectorAll('.selection input[type="checkbox"]:checked');&ndash;&gt;-->
<!--&lt;!&ndash;        checkboxes.forEach(checkbox => {&ndash;&gt;-->
<!--&lt;!&ndash;            checkbox.closest('tr').classList.add('marked-for-deletion');&ndash;&gt;-->
<!--&lt;!&ndash;        });&ndash;&gt;-->
<!--&lt;!&ndash;        // Show delete confirmation buttons&ndash;&gt;-->
<!--&lt;!&ndash;        document.querySelector('.btn-set2').style.display = 'block';&ndash;&gt;-->
<!--&lt;!&ndash;    }&ndash;&gt;-->

<!--&lt;!&ndash;    function confirmDelete() {&ndash;&gt;-->
<!--&lt;!&ndash;        const markedRecords = document.querySelectorAll('.marked-for-deletion');&ndash;&gt;-->
<!--&lt;!&ndash;        markedRecords.forEach(record => {&ndash;&gt;-->
<!--&lt;!&ndash;            const service = record.querySelector('td:nth-child(2)').textContent;&ndash;&gt;-->
<!--&lt;!&ndash;            // Assuming you have a function to call your API to delete the record&ndash;&gt;-->
<!--&lt;!&ndash;            deleteRecord(service); // Implement this function based on your API&ndash;&gt;-->
<!--&lt;!&ndash;            record.remove(); // Remove the record from the table&ndash;&gt;-->
<!--&lt;!&ndash;        });&ndash;&gt;-->
<!--&lt;!&ndash;        document.querySelector('.btn-set2').style.display = 'none'; // Hide confirmation buttons&ndash;&gt;-->
<!--&lt;!&ndash;    }&ndash;&gt;-->

<!--&lt;!&ndash;    function cancelDelete() {&ndash;&gt;-->
<!--&lt;!&ndash;        const markedRecords = document.querySelectorAll('.marked-for-deletion');&ndash;&gt;-->
<!--&lt;!&ndash;        markedRecords.forEach(record => {&ndash;&gt;-->
<!--&lt;!&ndash;            record.classList.remove('marked-for-deletion');&ndash;&gt;-->
<!--&lt;!&ndash;        });&ndash;&gt;-->
<!--&lt;!&ndash;        document.querySelector('.btn-set2').style.display = 'none'; // Hide confirmation buttons&ndash;&gt;-->
<!--&lt;!&ndash;    }&ndash;&gt;-->

<!--&lt;!&ndash;    async function addCredential() {&ndash;&gt;-->
<!--&lt;!&ndash;        const token = localStorage.getItem('token'); // Retrieve the token from local storage&ndash;&gt;-->
<!--&lt;!&ndash;        const platform = document.getElementById('platform').value;&ndash;&gt;-->
<!--&lt;!&ndash;        const username = document.getElementById('username').value;&ndash;&gt;-->
<!--&lt;!&ndash;        const password = document.getElementById('password').value;&ndash;&gt;-->

<!--&lt;!&ndash;        const response = await fetch('/user/credentials', { // Adjust the endpoint as needed&ndash;&gt;-->
<!--&lt;!&ndash;            method: 'POST',&ndash;&gt;-->
<!--&lt;!&ndash;            headers: {&ndash;&gt;-->
<!--&lt;!&ndash;                'Content-Type': 'application/json',&ndash;&gt;-->
<!--&lt;!&ndash;                'Authorization': `Bearer ${token}` // Include the token in the Authorization header&ndash;&gt;-->
<!--&lt;!&ndash;            },&ndash;&gt;-->
<!--&lt;!&ndash;            body: JSON.stringify({ service: platform, username, password }),&ndash;&gt;-->
<!--&lt;!&ndash;        });&ndash;&gt;-->

<!--&lt;!&ndash;        if (response.ok) {&ndash;&gt;-->
<!--&lt;!&ndash;            alert('Credential added successfully!');&ndash;&gt;-->
<!--&lt;!&ndash;            document.getElementById('addRecordModal').style.display = 'none';&ndash;&gt;-->
<!--&lt;!&ndash;            // Optionally, refresh the credentials list&ndash;&gt;-->
<!--&lt;!&ndash;            getUserData(); // Assuming you have this function to refresh the displayed credentials&ndash;&gt;-->
<!--&lt;!&ndash;        } else {&ndash;&gt;-->
<!--&lt;!&ndash;            // Handle errors, e.g., show an error message&ndash;&gt;-->
<!--&lt;!&ndash;            const errorMsg = await response.text();&ndash;&gt;-->
<!--&lt;!&ndash;            alert(`Failed to add credential: ${errorMsg}`);&ndash;&gt;-->
<!--&lt;!&ndash;        }&ndash;&gt;-->
<!--&lt;!&ndash;    }&ndash;&gt;-->

<!--&lt;!&ndash;    const searchInput = document.querySelector('.search-bar');&ndash;&gt;-->
<!--&lt;!&ndash;    searchInput.addEventListener('input', () => {&ndash;&gt;-->
<!--&lt;!&ndash;        const searchTerm = searchInput.value.toLowerCase();&ndash;&gt;-->
<!--&lt;!&ndash;        const filteredCredentials = credentials.filter(credential =>&ndash;&gt;-->
<!--&lt;!&ndash;            credential.service.toLowerCase().includes(searchTerm) ||&ndash;&gt;-->
<!--&lt;!&ndash;            credential.username.toLowerCase().includes(searchTerm)&ndash;&gt;-->
<!--&lt;!&ndash;        );&ndash;&gt;-->
<!--&lt;!&ndash;        populateTable(filteredCredentials);&ndash;&gt;-->
<!--&lt;!&ndash;    });&ndash;&gt;-->


<!--&lt;!&ndash;  function removeRecord() {&ndash;&gt;-->
<!--&lt;!&ndash;    recordsToDelete = []; // Clear existing records to delete&ndash;&gt;-->
<!--&lt;!&ndash;    const checkboxes = document.querySelectorAll('.selection input[type="checkbox"]:checked');&ndash;&gt;-->
<!--&lt;!&ndash;    checkboxes.forEach(checkbox => {&ndash;&gt;-->
<!--&lt;!&ndash;        const record = checkbox.closest('tr');&ndash;&gt;-->
<!--&lt;!&ndash;        record.classList.add('marked-for-deletion');&ndash;&gt;-->
<!--&lt;!&ndash;        recordsToDelete.push(record);&ndash;&gt;-->
<!--&lt;!&ndash;    });&ndash;&gt;-->
<!--&lt;!&ndash;    // Show delete confirmation buttons&ndash;&gt;-->
<!--&lt;!&ndash;    document.querySelector('.btn-set2').style.display = recordsToDelete.length > 0 ? 'block' : 'none';&ndash;&gt;-->
<!--&lt;!&ndash;}&ndash;&gt;-->

<!--&lt;!&ndash;function confirmDelete() {&ndash;&gt;-->
<!--&lt;!&ndash;    recordsToDelete.forEach(record => {&ndash;&gt;-->
<!--&lt;!&ndash;        const service = record.querySelector('td:nth-child(2)').textContent;&ndash;&gt;-->
<!--&lt;!&ndash;        // Store service names in an array for deletion&ndash;&gt;-->
<!--&lt;!&ndash;        recordsToDeleteNames.push(service);&ndash;&gt;-->
<!--&lt;!&ndash;        record.remove(); // Remove the record from the table&ndash;&gt;-->
<!--&lt;!&ndash;    });&ndash;&gt;-->
<!--&lt;!&ndash;    // Call the function to delete records in the backend&ndash;&gt;-->
<!--&lt;!&ndash;    deleteRecords(recordsToDeleteNames);&ndash;&gt;-->
<!--&lt;!&ndash;    document.querySelector('.btn-set2').style.display = 'none'; // Hide confirmation buttons&ndash;&gt;-->

<!--&lt;!&ndash;    // Clear the recordsToDeleteNames array after deletion is confirmed&ndash;&gt;-->
<!--&lt;!&ndash;    recordsToDeleteNames = [];&ndash;&gt;-->
<!--&lt;!&ndash;}&ndash;&gt;-->

<!--&lt;!&ndash;async function deleteRecords(recordNames) {&ndash;&gt;-->
<!--&lt;!&ndash;    try {&ndash;&gt;-->
<!--&lt;!&ndash;        const token = localStorage.getItem('token');&ndash;&gt;-->
<!--&lt;!&ndash;        const response = await fetch('/user/delete-records', { // Adjust the endpoint as needed&ndash;&gt;-->
<!--&lt;!&ndash;            method: 'POST',&ndash;&gt;-->
<!--&lt;!&ndash;            headers: {&ndash;&gt;-->
<!--&lt;!&ndash;                'Content-Type': 'application/json',&ndash;&gt;-->
<!--&lt;!&ndash;                'Authorization': `Bearer ${token}`&ndash;&gt;-->
<!--&lt;!&ndash;            },&ndash;&gt;-->
<!--&lt;!&ndash;            body: JSON.stringify({ records: recordNames }),&ndash;&gt;-->
<!--&lt;!&ndash;        });&ndash;&gt;-->

<!--&lt;!&ndash;        if (!response.ok) {&ndash;&gt;-->
<!--&lt;!&ndash;            console.error('Error deleting records:', response.statusText);&ndash;&gt;-->
<!--&lt;!&ndash;            // Handle error as needed&ndash;&gt;-->
<!--&lt;!&ndash;        }&ndash;&gt;-->
<!--&lt;!&ndash;    } catch (error) {&ndash;&gt;-->
<!--&lt;!&ndash;        console.error('Error during deleteRecords:', error);&ndash;&gt;-->
<!--&lt;!&ndash;    }&ndash;&gt;-->
<!--&lt;!&ndash;}&ndash;&gt;-->

<!--&lt;!&ndash;</script>&ndash;&gt;-->
<!--&lt;!&ndash;</body>&ndash;&gt;-->
<!--&lt;!&ndash;</html>&ndash;&gt;-->


<!--<!DOCTYPE html>-->
<!--<html lang="en">-->
<!--<head>-->
<!--    <meta charset="UTF-8">-->
<!--    <meta http-equiv="X-UA-Compatible" content="IE=edge">-->
<!--    <meta name="viewport" content="width=device-width, initial-scale=1.0">-->
<!--    <link rel="preconnect" href="https://fonts.googleapis.com">-->
<!--    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>-->
<!--    <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@300&display=swap" rel="stylesheet">-->
<!--    <link rel="stylesheet" href="css/password-view.css">-->
<!--    <link rel="stylesheet" href="css/user-menu.css">-->
<!--    <title>Password Manager</title>-->
<!--</head>-->
<!--<body>-->

<!--&lt;!&ndash; Password Manager Main UI &ndash;&gt;-->
<!--<div class="navigation">-->
<!--    <input class="search-bar" type="search" placeholder="Filter Platform & Username">-->

<!--    <nav class="btn-set1">-->
<!--        <input class="action-btn logout" type="button" onclick="logout()">-->
<!--        <input class="action-btn add-record" type="button" onclick="openAddRecord()">-->
<!--        <input class="action-btn remove-record" type="button" onclick="removeRecord()">-->
<!--    </nav>-->

<!--    <nav class="btn-set2">-->
<!--        <input class="action-btn confirm-delete" type="button" onclick="confirmDelete()">-->
<!--        <input class="action-btn cancel-delete" type="button" onclick="cancelDelete()">-->
<!--    </nav>-->
<!--</div>-->

<!--<div class="table-container">-->
<!--    <div id="addRecordModal" class="modal" style="display:none;">-->
<!--        <div class="modal-content">-->
<!--            <span class="close-button" onclick="closeModal()">&times;</span>-->
<!--            <h2>Add New Credential</h2>-->
<!--            <form id="addCredentialForm">-->
<!--                <label for="platform">Platform:</label>-->
<!--                <input type="text" id="platform" name="platform" required>-->

<!--                <label for="username">Username:</label>-->
<!--                <input type="text" id="username" name="username" required>-->

<!--                <label for="password">Password:</label>-->
<!--                <input type="password" id="password" name="password" required>-->

<!--                <button type="button" onclick="addCredential()">Add Credential</button>-->
<!--            </form>-->
<!--        </div>-->
<!--    </div>-->

<!--    <table class="styled-table">-->
<!--        <thead>-->
<!--            <tr>-->
<!--                <th class="selection">Selection</th>-->
<!--                <th>Platform</th>-->
<!--                <th>Username</th>-->
<!--                <th>Password</th>-->
<!--            </tr>-->
<!--        </thead>-->
<!--        <tbody>-->
<!--            &lt;!&ndash; Data will be populated here &ndash;&gt;-->
<!--        </tbody>-->
<!--    </table>-->
<!--</div>-->

<!--<script>-->
<!--    let credentials = []; // Define credentials globally-->
<!--    let recordsToDelete = []; // Define recordsToDelete globally-->

<!--    async function getUserData() {-->
<!--        try {-->
<!--            const token = localStorage.getItem('token'); // Retrieve the token from local storage-->
<!--            const response = await fetch('http://localhost:3000/data', {-->
<!--                method: 'GET',-->
<!--                headers: {-->
<!--                    'Authorization': `Bearer ${token}` // Include the token in the Authorization header-->
<!--                }-->
<!--            });-->
<!--            if (response.ok) {-->
<!--                const data = await response.json();-->
<!--                credentials = data.credentials; // Update global credentials array-->
<!--                populateTable(credentials);-->
<!--            } else {-->
<!--                console.error('Error fetching user data:', response.statusText);-->
<!--                // Optionally, redirect to login page if unauthorized-->
<!--                if (response.status === 401) {-->
<!--                    window.location.href = 'login.html';-->
<!--                }-->
<!--            }-->
<!--        } catch (error) {-->
<!--            console.error('Error during getUserData:', error);-->
<!--        }-->
<!--    }-->

<!--    function populateTable(credentials) {-->
<!--        const tbody = document.querySelector('.styled-table tbody');-->
<!--        tbody.innerHTML = ''; // Clear existing rows-->

<!--        credentials.forEach((credential) => {-->
<!--            const row = document.createElement('tr');-->
<!--            row.innerHTML = `-->
<!--                <td class="selection"><input type="checkbox"></td>-->
<!--                <td>${credential.service}</td>-->
<!--                <td>${credential.username}</td>-->
<!--                <td>-->
<!--                    <span class="password-display" data-password="${credential.password}">********</span>-->
<!--                    <span class="eye-icon" onclick="togglePasswordVisibility(this)">üëÅÔ∏è</span>-->
<!--                    <span class="clipboard-icon" onclick="copyToClipboard('${credential.password}')">üìã</span>-->
<!--                </td>-->
<!--            `;-->
<!--            tbody.appendChild(row);-->
<!--        });-->
<!--    }-->

<!--    function togglePasswordVisibility(icon) {-->
<!--        const passwordDisplay = icon.parentElement.querySelector('.password-display');-->
<!--        const actualPassword = passwordDisplay.getAttribute('data-password');-->
<!--        passwordDisplay.textContent = passwordDisplay.textContent === '********' ? actualPassword : '********';-->
<!--    }-->

<!--    function copyToClipboard(text) {-->
<!--        navigator.clipboard.writeText(text).then(() => {-->
<!--            alert('Password copied to clipboard!');-->
<!--        }, (err) => {-->
<!--            console.error('Error copying text to clipboard', err);-->
<!--        });-->
<!--    }-->

<!--    // Call getUserData when the page loads-->
<!--    window.addEventListener('DOMContentLoaded', (event) => {-->
<!--        getUserData();-->
<!--    });-->

<!--    function logout() {-->
<!--        localStorage.removeItem('userSession');-->
<!--        window.location.href = 'login.html';-->
<!--    }-->

<!--    function openAddRecord() {-->
<!--        document.getElementById('addRecordModal').style.display = 'block';-->
<!--    }-->

<!--    function removeRecord() {-->
<!--        recordsToDelete = []; // Clear existing records to delete-->
<!--        const checkboxes = document.querySelectorAll('.selection input[type="checkbox"]');-->
<!--        checkboxes.forEach(checkbox => {-->
<!--            checkbox.checked = false;-->
<!--            checkbox.addEventListener('change', function () {-->
<!--                const record = this.closest('tr');-->
<!--                if (this.checked) {-->
<!--                    record.classList.add('marked-for-deletion');-->
<!--                    recordsToDelete.push(record);-->
<!--                } else {-->
<!--                    record.classList.remove('marked-for-deletion');-->
<!--                    const index = recordsToDelete.indexOf(record);-->
<!--                    if (index !== -1) {-->
<!--                        recordsToDelete.splice(index, 1);-->
<!--                    }-->
<!--                }-->

<!--                // Show delete confirmation buttons-->
<!--                document.querySelector('.btn-set2').style.display = recordsToDelete.length > 0 ? 'block' : 'none';-->
<!--            });-->
<!--        });-->
<!--    }-->

<!--    function confirmDelete() {-->
<!--        recordsToDelete.forEach(record => {-->
<!--            const service = record.querySelector('td:nth-child(2)').textContent;-->
<!--            // Store service names in an array for deletion-->
<!--            deleteRecord(service); // Implement this function based on your API-->
<!--            record.remove(); // Remove the record from the table-->
<!--        });-->
<!--        document.querySelector('.btn-set2').style.display = 'none'; // Hide confirmation buttons-->
<!--    }-->

<!--    function cancelDelete() {-->
<!--        recordsToDelete.forEach(record => {-->
<!--            record.classList.remove('marked-for-deletion');-->
<!--        });-->
<!--        recordsToDelete = []; // Clear the recordsToDelete array-->
<!--        document.querySelector('.btn-set2').style.display = 'none'; // Hide confirmation buttons-->
<!--    }-->

<!--    async function deleteRecord(service) {-->
<!--        try {-->
<!--            const token = localStorage.getItem('token');-->
<!--            const response = await fetch('/user/delete-record', { // Adjust the endpoint as needed-->
<!--                method: 'POST',-->
<!--                headers: {-->
<!--                    'Content-Type': 'application/json',-->
<!--                    'Authorization': `Bearer ${token}`-->
<!--                },-->
<!--                body: JSON.stringify({ service }),-->
<!--            });-->

<!--            if (!response.ok) {-->
<!--                console.error('Error deleting record:', response.statusText);-->
<!--                // Handle error as needed-->
<!--            }-->
<!--        } catch (error) {-->
<!--            console.error('Error during deleteRecord:', error);-->
<!--        }-->
<!--    }-->

<!--    async function addCredential() {-->
<!--        const token = localStorage.getItem('token'); // Retrieve the token from local storage-->
<!--        const platform = document.getElementById('platform').value;-->
<!--        const username = document.getElementById('username').value;-->
<!--        const password = document.getElementById('password').value;-->

<!--        const response = await fetch('/user/credentials', { // Adjust the endpoint as needed-->
<!--            method: 'POST',-->
<!--            headers: {-->
<!--                'Content-Type': 'application/json',-->
<!--                'Authorization': `Bearer ${token}` // Include the token in the Authorization header-->
<!--            },-->
<!--            body: JSON.stringify({ service: platform, username, password }),-->
<!--        });-->

<!--        if (response.ok) {-->
<!--            alert('Credential added successfully!');-->
<!--            document.getElementById('addRecordModal').style.display = 'none';-->
<!--            // Optionally, refresh the credentials list-->
<!--            await getUserData(); // Assuming you have this function to refresh the displayed credentials-->
<!--        } else {-->
<!--            // Handle errors, e.g., show an error message-->
<!--            const errorMsg = await response.text();-->
<!--            alert(`Failed to add credential: ${errorMsg}`);-->
<!--        }-->
<!--    }-->

<!--    const searchInput = document.querySelector('.search-bar');-->
<!--    searchInput.addEventListener('input', () => {-->
<!--        const searchTerm = searchInput.value.toLowerCase();-->
<!--        const filteredCredentials = credentials.filter(credential =>-->
<!--            credential.service.toLowerCase().includes(searchTerm) ||-->
<!--            credential.username.toLowerCase().includes(searchTerm)-->
<!--        );-->
<!--        populateTable(filteredCredentials);-->
<!--    });-->

<!--    function closeModal() {-->
<!--    document.getElementById('addRecordModal').style.display = 'none';-->
<!--}-->
<!--</script>-->
<!--</body>-->
<!--</html>-->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@300&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/password-view.css">
    <link rel="stylesheet" href="css/user-menu.css">
    <title>Password Manager</title>
</head>
<body>

<!-- Password Manager Main UI -->
<div class="navigation">
    <input class="search-bar" type="search" placeholder="Filter Platform & Username">

    <nav class="btn-set1">
        <input class="action-btn logout" type="button" onclick="logout()">
        <input class="action-btn add-record" type="button" onclick="openAddRecord()">
    </nav>
</div>

<div class="table-container">
    <div id="addRecordModal" class="modal" style="display:none;">
        <div class="modal-content">
            <span class="close-button" onclick="closeModal()">&times;</span>
            <h2>Add New Credential</h2>
            <form id="addCredentialForm">
                <label for="platform">Platform:</label>
                <input type="text" id="platform" name="platform" required>

                <label for="username">Username:</label>
                <input type="text" id="username" name="username" required>

                <label for="password">Password:</label>
                <input type="password" id="password" name="password" required>

                <button type="button" onclick="addCredential()">Add Credential</button>
            </form>
        </div>
    </div>

    <table class="styled-table">
        <thead>
            <tr>
                <th>Platform</th>
                <th>Username</th>
                <th>Password</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody>
            <!-- Data will be populated here -->
        </tbody>
    </table>
</div>

<script>
    let credentials = []; // Define credentials globally

    async function getUserData() {
        try {
            const token = localStorage.getItem('token'); // Retrieve the token from local storage
            const response = await fetch('http://localhost:3000/data', {
                method: 'GET',
                headers: {
                    'Authorization': `Bearer ${token}` // Include the token in the Authorization header
                }
            });
            if (response.ok) {
                const data = await response.json();
                credentials = data.credentials;
                populateTable(credentials);
            } else {
                console.error('Error fetching user data:', response.statusText);
                // Optionally, redirect to login page if unauthorized
                if (response.status === 401) {
                    window.location.href = 'login.html';
                }
            }
        } catch (error) {
            console.error('Error during getUserData:', error);
        }
    }

    function populateTable(credentials) {
        const tbody = document.querySelector('.styled-table tbody');
        tbody.innerHTML = ''; // Clear existing rows

        credentials.forEach((credential) => {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td>${credential.service}</td>
                <td>${credential.username}</td>
                <td>
                    <span class="password-display" data-password="${credential.password}">********</span>
                    <span class="eye-icon" onclick="togglePasswordVisibility(this)">üëÅÔ∏è</span>
                    <span class="clipboard-icon" onclick="copyToClipboard('${credential.password}')">üìã</span>
                </td>
                <td><button class="delete-btn" onclick="removeCredential('${credential.service}')">Delete</button></td>
            `;
            tbody.appendChild(row);
        });
    }

    function togglePasswordVisibility(icon) {
        const passwordDisplay = icon.parentElement.querySelector('.password-display');
        const actualPassword = passwordDisplay.getAttribute('data-password');
        passwordDisplay.textContent = passwordDisplay.textContent === '********' ? actualPassword : '********';
    }

    function copyToClipboard(text) {
        navigator.clipboard.writeText(text).then(() => {
            alert('Password copied to clipboard!');
        }, (err) => {
            console.error('Error copying text to clipboard', err);
        });
    }

    // Call getUserData when the page loads
    window.addEventListener('DOMContentLoaded', (event) => {
        getUserData();
    });

    function logout() {
        localStorage.removeItem('userSession');
        window.location.href = 'login.html';
    }

    function openAddRecord() {
        document.getElementById('addRecordModal').style.display = 'block';
    }

    function closeModal() {
        document.getElementById('addRecordModal').style.display = 'none';
    }

    async function addCredential() {
        const token = localStorage.getItem('token'); // Retrieve the token from local storage
        const platform = document.getElementById('platform').value;
        const username = document.getElementById('username').value;
        const password = document.getElementById('password').value;

        const response = await fetch('/user/credentials', { // Adjust the endpoint as needed
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Authorization': `Bearer ${token}` // Include the token in the Authorization header
            },
            body: JSON.stringify({ service: platform, username, password }),
        });

        if (response.ok) {
            alert('Credential added successfully!');
            closeModal();
            // Refresh the credentials list
            getUserData();
        } else {
            // Handle errors, e.g., show an error message
            const errorMsg = await response.text();
            alert(`Failed to add credential: ${errorMsg}`);
        }
    }

    async function removeCredential(service) {
        const confirmation = confirm(`Are you sure you want to delete the credential for ${service}?`);
        if (confirmation) {
            // Call the function to delete the credential in the backend
            await deleteCredential(service);
            // Refresh the credentials list
            getUserData();
        }
    }

    async function deleteCredential(service) {
        try {
            const token = localStorage.getItem('token');
            const response = await fetch('/user/delete-credential', { // Adjust the endpoint as needed
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${token}`
                },
                body: JSON.stringify({ service }),
            });

            if (!response.ok) {
                console.error('Error deleting credential:', response.statusText);
                // Handle error as needed
            }
        } catch (error) {
            console.error('Error during deleteCredential:', error);
        }
    }
</script>
</body>
</html>
